(this["webpackJsonpsimple-sim-sir"]=this["webpackJsonpsimple-sim-sir"]||[]).push([[0],{12:function(e,t,i){},13:function(e,t,i){},14:function(e,t,i){"use strict";i.r(t);var a,n=i(0),o=i.n(n),s=i(5),r=i.n(s),l=i(1),c=(i(12),i(6)),u={canvasWidth:.8*window.innerWidth,canvasHeight:.8*window.innerHeight,ballRadius:10,maxVelocity:1,initialInfectious:10,initialPopulationSize:200,transmissionRate:.02,timeToRemoved:10},h=i(2),m=i(3);!function(e){e.INFECTIOUS="INFECTIOUS",e.SUSCEPTIBLE="SUSCEPTIBLE",e.REMOVED="REMOVED"}(a||(a={}));var d=function(){function e(t,i){Object(h.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=i}return Object(m.a)(e,[{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"magnitude",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"normalize",value:function(){return new e(this.x/this.magnitude(),this.y/this.magnitude())}},{key:"scale",value:function(t){return new e(this.x*t,this.y*t)}}]),e}(),v=function(e){return 1+Math.floor(Math.random()*e)},p=function(){function e(t){var i=t.ctx,n=t.index;Object(h.a)(this,e),this.position=void 0,this.velocity=void 0,this.relation=void 0,this.radius=void 0,this.count=void 0,this.ctx=void 0,this.ctx=i,this.count=n+1,this.position=new d(v(u.canvasWidth),v(u.canvasHeight)),this.velocity=new d(Math.round(Math.random()*u.maxVelocity),Math.round(Math.random()*u.maxVelocity)),this.relation=this.count<=u.initialInfectious?a.INFECTIOUS:a.SUSCEPTIBLE,this.radius=u.ballRadius}return Object(m.a)(e,[{key:"draw",value:function(){var e=this.ctx;e.fillStyle=function(e){switch(e){case a.INFECTIOUS:return"red";case a.REMOVED:return"white";default:return"dodgerblue"}}(this.relation),e.shadowColor=function(e){switch(e){case a.INFECTIOUS:return"yellow";case a.REMOVED:return"limegreen";default:return"deepskyblue"}}(this.relation),e.shadowBlur=u.ballRadius,e.save(),e.scale(1,1),e.translate(this.position.x-10,this.position.y-10);var t=new Path2D;t.moveTo(220,60),t.arc(170,60,u.ballRadius,0,2*Math.PI),e.scale(.1,.1),e.fill(t),e.restore()}},{key:"translate",value:function(){(this.position.x<=2*this.radius||this.position.x>=u.canvasWidth-2*this.radius)&&(this.velocity.x=-this.velocity.x),(this.position.y<=2*this.radius||this.position.y>=u.canvasHeight-2*this.radius)&&(this.velocity.y=-this.velocity.y),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}},{key:"update",value:function(){this.translate(),this.draw()}},{key:"collide",value:function(e){var t={x:this.velocity.x,y:this.velocity.y};this.velocity.x=e.velocity.x,this.velocity.y=e.velocity.y,e.velocity.x=t.x,e.velocity.y=t.y}}]),e}(),f=function(){function e(t){var i=t.ctx,a=t.width,n=t.height,o=t.popSize,s=t.timeToRemoved,r=t.transmissionRate,l=t.stats;Object(h.a)(this,e),this.width=void 0,this.height=void 0,this.balls=void 0,this.ctx=void 0,this.popSize=void 0,this.timeToRemoved=void 0,this.transmissionRate=void 0,this.stats=void 0,this.width=a,this.height=n,this.balls=[],this.ctx=i,this.popSize=o,this.timeToRemoved=s,this.transmissionRate=r,this.stats=l,this.populate(),this.update()}return Object(m.a)(e,[{key:"coinFlip",value:function(){return Math.random()<=this.transmissionRate}},{key:"tryInfect",value:function(e){e.relation!==a.INFECTIOUS&&e.relation!==a.REMOVED&&!0===this.coinFlip()&&(e.relation=a.INFECTIOUS,setTimeout((function(){e.relation=a.REMOVED}),1e3*this.timeToRemoved))}},{key:"update",value:function(){var e=this,t=this.balls.length;this.ctx.clearRect(0,0,u.canvasWidth,u.canvasHeight),this.balls.forEach((function(e){e.update()}));for(var i=0;i<t;i++)for(var n=0;n<t;n++)i!==n&&this.isCollided(this.balls[i],this.balls[n])&&(this.balls[i].collide(this.balls[n]),this.balls[i].relation===a.INFECTIOUS&&this.tryInfect(this.balls[n]),this.balls[n].relation===a.INFECTIOUS&&this.tryInfect(this.balls[i]),this.balls[i].update(),this.balls[n].update());requestAnimationFrame((function(){e.update()}))}},{key:"distance",value:function(e,t){return Math.sqrt((e.position.x-t.position.x)*(e.position.x-t.position.x)+(e.position.y-t.position.y)*(e.position.y-t.position.y))}},{key:"isCollided",value:function(e,t){return this.distance(e,t)<=e.radius+t.radius}},{key:"populate",value:function(){for(var e=0;e<this.popSize;e++){var t=new p({ctx:this.ctx,index:e});this.balls.push(t),this.balls[e].draw()}}},{key:"getStats",value:function(){var e=0,t=0,i=0;return this.balls.map((function(e){return e.relation})).forEach((function(n){n===a.INFECTIOUS&&(t+=1),n===a.SUSCEPTIBLE&&(e+=1),n===a.REMOVED&&(i+=1)})),console.log(this.balls.length),{S:e,I:t,R:i}}}]),e}(),b=function(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(t.current){var i=t.current.getContext("2d");if(null===i||void 0===i||i.clearRect(0,0,u.canvasWidth,u.canvasHeight),i){var a=new f({ctx:i,height:u.canvasHeight,width:u.canvasWidth,popSize:e.populationSize,timeToRemoved:e.timeToRemoved,transmissionRate:e.transmissionRate,stats:e.stats});if(setInterval((function(){var t=a.getStats();e.handleSetStats(Object(c.a)({},t))}),1e3))return function(){clearInterval()}}}}),[e.transmissionRate,e.populationSize,e.timeToRemoved]),o.a.createElement("canvas",{ref:t,width:u.canvasWidth,height:u.canvasHeight})},y=function(){return o.a.createElement("footer",{className:"jumbotron jumbotron-fluid  bg-dark"},o.a.createElement("div",{className:"container"},o.a.createElement("h1",{className:"display-4"},"SIR simulering"),o.a.createElement("p",{className:"lead"},"av Daniel Sonne Lehnberg"),o.a.createElement("p",null,"GitHub:"," ",o.a.createElement("a",{href:"https://github.com/doddydigitaldesign/simple-sim-sir"},"https://github.com/doddydigitaldesign/simple-sim-sir")),o.a.createElement("span",null,"MIT License")))},g=function(e){return o.a.createElement("div",null,o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"popsize-input","aria-describedby":"popsizeHelp"},"Antal individer"),o.a.createElement("small",{id:"popsizeHelp",className:"form-text"},"Se hur resultatet p\xe5verkas med olika antal individer i omr\xe5det."),o.a.createElement("input",{className:"form-control",type:"number",min:0,max:1e3,value:e.populationSize,onChange:e.setPopulationSize,name:"population-size",id:"popsize-input"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"time-to-removed-input","aria-describedby":"timeToRemovedHelp"},"Smittsamhetstid"),o.a.createElement("small",{id:"timeToRemovedHelp",className:"form-text"},"Se hur resultatet p\xe5verkas om individer \xe4r smittsamma l\xe4ngre eller kortare perioder."),o.a.createElement("input",{className:"form-control",type:"number",value:e.timeToRemoved,min:.01,max:100,onChange:e.setTimeToRemoved,name:"time-to-removed-input",id:"time-to-removed-input"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"transmission-rate-input","aria-describedby":"timeToRemovedHelp"},"Virulens"),o.a.createElement("small",{id:"transmissionRateHelp",className:"form-text"},"Se hur resultatet p\xe5verkas om risken att smittan sprids \xe4ndras."),o.a.createElement("input",{className:"form-control",type:"number",value:e.transmissionRate,onChange:e.setTransmissionRate,name:"transmission-rate-input",id:"transmission-rate-input"}))))},E=function(e){return o.a.createElement("li",{className:"list-group-item "+e.bgColor},o.a.createElement("span",{className:"text-"+e.textColor},e.text))},S=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("ul",{className:"list-group"},o.a.createElement(E,{textColor:"light",bgColor:"bg-primary",text:"S, antal mottagliga: "+e.susceptible}),o.a.createElement(E,{textColor:"light",bgColor:"bg-danger",text:"I, antal infekterade: "+e.infected}),o.a.createElement(E,{textColor:"dark",bgColor:"bg-light",text:"R, antal immuna eller d\xf6da: "+e.removed})))};var x=function(){var e=Object(n.useState)(u.initialPopulationSize),t=Object(l.a)(e,2),i=t[0],a=t[1],s=Object(n.useState)(u.timeToRemoved),r=Object(l.a)(s,2),c=r[0],h=r[1],m=Object(n.useState)(u.initialPopulationSize-u.initialInfectious),d=Object(l.a)(m,2),v=d[0],p=d[1],f=Object(n.useState)(u.initialInfectious),E=Object(l.a)(f,2),x=E[0],R=E[1],w=Object(n.useState)(0),I=Object(l.a)(w,2),O=I[0],T=I[1],k=Object(n.useState)(u.transmissionRate),C=Object(l.a)(k,2),N=C[0],j=C[1],z=function(e){R(e.I),T(e.R),p(e.S)};return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement("h1",{className:"h1"},"SIR Simulering"),o.a.createElement(g,{populationSize:i,setPopulationSize:function(e){var t=parseInt(e.target.value,10);"number"===typeof t&&(a(t),p(t-O-x))},timeToRemoved:c,setTimeToRemoved:function(e){var t=parseFloat(e.target.value);"number"===typeof t&&h(t)},transmissionRate:N,setTransmissionRate:function(e){var t=parseFloat(e.target.value);"number"===typeof t&&j(t)}}),o.a.createElement(b,{stats:{S:v,I:x,R:O},transmissionRate:N,handleSetStats:Object(n.useCallback)(z,[z]),timeToRemoved:c,populationSize:i}),o.a.createElement(S,{infected:x,susceptible:v,removed:O})),o.a.createElement(y,null))},R=(i(13),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function w(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var i=e.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var I=document.getElementById("root");I&&r.a.createRoot(I).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null))),function(e){if("serviceWorker"in navigator){if(new URL("/simple-sim-sir",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/simple-sim-sir","/service-worker.js");R?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(i){var a=i.headers.get("content-type");404===i.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):w(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):w(t,e)}))}}()},7:function(e,t,i){e.exports=i(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.6335062c.chunk.js.map