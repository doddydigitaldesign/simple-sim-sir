(this["webpackJsonpsimple-sim-sir"]=this["webpackJsonpsimple-sim-sir"]||[]).push([[0],{12:function(t,e,i){},13:function(t,e,i){},14:function(t,e,i){"use strict";i.r(e);var a,n=i(0),o=i.n(n),s=i(5),r=i.n(s),l=i(1),c=(i(12),i(6)),u={canvasWidth:.8*window.innerWidth,canvasHeight:.8*window.innerHeight,ballRadius:5,maxVelocity:1,initialInfectious:10,initialPopulationSize:100,transmissionRate:.02,timeToRemoved:10},h=i(2),m=i(3);!function(t){t.INFECTIOUS="INFECTIOUS",t.SUSCEPTIBLE="SUSCEPTIBLE",t.REMOVED="REMOVED"}(a||(a={}));var d=function(){function t(e,i){Object(h.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=i}return Object(m.a)(t,[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"magnitude",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"normalize",value:function(){return new t(this.x/this.magnitude(),this.y/this.magnitude())}},{key:"scale",value:function(e){return new t(this.x*e,this.y*e)}}]),t}(),v=function(t){return 1+Math.floor(Math.random()*t)},p=function(){function t(e){var i=e.ctx,n=e.index,o=e.timeToRemoved;Object(h.a)(this,t),this.position=void 0,this.velocity=void 0,this.relation=void 0,this.radius=void 0,this.count=void 0,this.timeToRemoved=void 0,this.ctx=void 0,this.ctx=i,this.count=n+1,this.position=new d(v(u.canvasWidth),v(u.canvasHeight)),this.velocity=new d(Math.round(Math.random()*u.maxVelocity),Math.round(Math.random()*u.maxVelocity)),this.relation=this.count<=u.initialInfectious?a.INFECTIOUS:a.SUSCEPTIBLE,this.radius=u.ballRadius,this.timeToRemoved=o}return Object(m.a)(t,[{key:"draw",value:function(){var t=this.ctx;t.fillStyle=function(t){switch(t){case a.INFECTIOUS:return"red";case a.REMOVED:return"white";default:return"dodgerblue"}}(this.relation),t.shadowColor=function(t){switch(t){case a.INFECTIOUS:return"yellow";case a.REMOVED:return"limegreen";default:return"deepskyblue"}}(this.relation),t.shadowBlur=u.ballRadius,t.save(),t.scale(1,1),t.translate(this.position.x-10,this.position.y-10);var e=new Path2D;e.moveTo(220,60),e.arc(170,60,u.ballRadius,0,2*Math.PI),t.scale(.5,.5),t.fill(e),t.restore()}},{key:"translate",value:function(){(this.position.x<=this.radius||this.position.x>=u.canvasWidth-this.radius)&&(this.velocity.x=-this.velocity.x),(this.position.y<=this.radius||this.position.y>=u.canvasHeight-this.radius)&&(this.velocity.y=-this.velocity.y),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}},{key:"update",value:function(){this.translate(),this.draw()}},{key:"infect",value:function(){var t=this;this.relation=a.INFECTIOUS,setTimeout((function(){t.relation=a.REMOVED}),1e3*this.timeToRemoved)}},{key:"collide",value:function(t){var e={x:this.velocity.x,y:this.velocity.y};this.velocity.x=t.velocity.x,this.velocity.y=t.velocity.y,t.velocity.x=e.x,t.velocity.y=e.y}}]),t}(),f=function(){function t(e){var i=e.ctx,a=e.width,n=e.height,o=e.popSize,s=e.timeToRemoved,r=e.transmissionRate,l=e.stats;Object(h.a)(this,t),this.width=void 0,this.height=void 0,this.balls=void 0,this.ctx=void 0,this.popSize=void 0,this.timeToRemoved=void 0,this.transmissionRate=void 0,this.stats=void 0,this.width=a,this.height=n,this.balls=[],this.ctx=i,this.popSize=o,this.timeToRemoved=s,this.transmissionRate=r,this.stats=l,this.populate(),this.update()}return Object(m.a)(t,[{key:"coinFlip",value:function(){return Math.random()<=this.transmissionRate}},{key:"tryInfect",value:function(t){t.relation!==a.INFECTIOUS&&t.relation!==a.REMOVED&&!0===this.coinFlip()&&(t.relation=a.INFECTIOUS,setTimeout((function(){t.relation=a.REMOVED}),1e3*this.timeToRemoved))}},{key:"update",value:function(){var t=this,e=this.balls.length;this.ctx.clearRect(0,0,u.canvasWidth,u.canvasHeight),this.balls.forEach((function(t){t.update()}));for(var i=0;i<e;i++)for(var n=0;n<e;n++)i!==n&&this.isCollided(this.balls[i],this.balls[n])&&(this.balls[i].collide(this.balls[n]),this.balls[i].relation===a.INFECTIOUS&&this.tryInfect(this.balls[n]),this.balls[n].relation===a.INFECTIOUS&&this.tryInfect(this.balls[i]),this.balls[i].update(),this.balls[n].update());requestAnimationFrame((function(){t.update()}))}},{key:"distance",value:function(t,e){return Math.sqrt((t.position.x-e.position.x)*(t.position.x-e.position.x)+(t.position.y-e.position.y)*(t.position.y-e.position.y))}},{key:"isCollided",value:function(t,e){return this.distance(t,e)<=t.radius+e.radius}},{key:"populate",value:function(){for(var t=0;t<this.popSize;t++){var e=new p({ctx:this.ctx,index:t,timeToRemoved:this.timeToRemoved});this.balls.push(e),this.balls[t].draw()}}},{key:"getStats",value:function(){var t=0,e=0,i=0;return this.balls.map((function(t){return t.relation})).forEach((function(n){n===a.INFECTIOUS&&(e+=1),n===a.SUSCEPTIBLE&&(t+=1),n===a.REMOVED&&(i+=1)})),console.log(this.balls.length),{S:t,I:e,R:i}}}]),t}(),y=function(t){var e=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(e.current){var i=e.current.getContext("2d");if(null===i||void 0===i||i.clearRect(0,0,u.canvasWidth,u.canvasHeight),i){var a=new f({ctx:i,height:u.canvasHeight,width:u.canvasWidth,popSize:t.populationSize,timeToRemoved:t.timeToRemoved,transmissionRate:t.transmissionRate,stats:t.stats});if(setInterval((function(){var e=a.getStats();t.handleSetStats(Object(c.a)({},e))}),1e3))return function(){clearInterval()}}}}),[t.populationSize,t.timeToRemoved]),o.a.createElement("canvas",{ref:e,width:u.canvasWidth,height:u.canvasHeight})},b=function(t){return o.a.createElement("div",null,o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"popsize-input","aria-describedby":"popsizeHelp"},"Antal individer"),o.a.createElement("small",{id:"popsizeHelp",className:"form-text text-muted"},"Se hur resultatet p\xe5verkas med olika antal individer i omr\xe5det."),o.a.createElement("input",{className:"form-control",type:"number",min:0,max:1e3,value:t.populationSize,onChange:t.setPopulationSize,name:"population-size",id:"popsize-input"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"time-to-removed-input","aria-describedby":"timeToRemovedHelp"},"Tid till frisk"),o.a.createElement("small",{id:"timeToRemovedHelp",className:"form-text text-muted"},"Se hur resultatet p\xe5verkas med olika l\xe4ngder p\xe5 sjukdomen."),o.a.createElement("input",{className:"form-control",type:"number",value:t.timeToRemoved,min:.01,max:100,onChange:t.setTimeToRemoved,name:"time-to-removed-input",id:"time-to-removed-input"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"transmission-rate-input","aria-describedby":"timeToRemovedHelp"},"Smittrisk"),o.a.createElement("small",{id:"transmissionRateHelp",className:"form-text text-muted"},"Se hur resultatet p\xe5verkas om smittrisken \xe4ndras."),o.a.createElement("input",{className:"form-control",type:"number",value:t.transmissionRate,onChange:t.setTransmissionRate,name:"transmission-rate-input",id:"transmission-rate-input"}))))},g=function(t){return o.a.createElement("li",{className:"list-group-item "+t.bgColor},o.a.createElement("span",{className:"text-"+t.textColor},t.text))},E=function(t){return o.a.createElement(o.a.Fragment,null,o.a.createElement("ul",{className:"list-group"},o.a.createElement(g,{textColor:"light",bgColor:"bg-primary",text:"Mottagliga: "+t.susceptible}),o.a.createElement(g,{textColor:"light",bgColor:"bg-danger",text:"Infekterade: "+t.infected}),o.a.createElement(g,{textColor:"dark",bgColor:"bg-light",text:"Tillfrisknade: "+t.removed})))};var x=function(){var t=Object(n.useState)(u.initialPopulationSize),e=Object(l.a)(t,2),i=e[0],a=e[1],s=Object(n.useState)(u.timeToRemoved),r=Object(l.a)(s,2),c=r[0],h=r[1],m=Object(n.useState)(u.initialPopulationSize-u.initialInfectious),d=Object(l.a)(m,2),v=d[0],p=d[1],f=Object(n.useState)(u.initialInfectious),g=Object(l.a)(f,2),x=g[0],S=g[1],R=Object(n.useState)(0),w=Object(l.a)(R,2),T=w[0],I=w[1],k=Object(n.useState)(u.transmissionRate),O=Object(l.a)(k,2),C=O[0],N=O[1],j=function(t){S(t.I),I(t.R),p(t.S)};return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement("h1",{className:"h1"},"SIR Simulering"),o.a.createElement(b,{populationSize:i,setPopulationSize:function(t){var e=parseInt(t.target.value,10);"number"===typeof e&&(a(e),p(e-T-x))},timeToRemoved:c,setTimeToRemoved:function(t){var e=parseFloat(t.target.value);"number"===typeof e&&h(e)},transmissionRate:C,setTransmissionRate:function(t){var e=parseFloat(t.target.value);"number"===typeof e&&N(e)}}),o.a.createElement(y,{stats:{S:v,I:x,R:T},transmissionRate:C,handleSetStats:Object(n.useCallback)(j,[j]),timeToRemoved:c,populationSize:i}),o.a.createElement(E,{infected:x,susceptible:v,removed:T})))},S=(i(13),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function R(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var i=t.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}var w=document.getElementById("root");w&&r.a.createRoot(w).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null))),function(t){if("serviceWorker"in navigator){if(new URL("/simple-sim-sir",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/simple-sim-sir","/service-worker.js");S?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(i){var a=i.headers.get("content-type");404===i.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):R(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):R(e,t)}))}}()},7:function(t,e,i){t.exports=i(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.8466d64f.chunk.js.map